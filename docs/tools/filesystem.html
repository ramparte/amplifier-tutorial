<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Filesystem - Amplifier Tutorial</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Filesystem";
        var mkdocs_page_input_path = "tools/filesystem.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Amplifier Tutorial
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/what-is-amplifier.html">What is Amplifier?</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/how-its-different.html">How It's Different</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/installation.html">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/first-conversation.html">Your First Conversation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/key-commands.html">Key Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quickstart/first-bundle.html">Your First Bundle</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Core Concepts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/architecture.html">Architecture Deep Dive</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/modules.html">Modules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/bundles.html">Bundles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/agents.html">Agents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/recipes.html">Recipes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/skills.html">Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../concepts/hooks.html">Hooks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="filesystem.html">Filesystem</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#operations">Operations</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reading-files">Reading Files</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#basic-file-reading">Basic File Reading</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#reading-large-files">Reading Large Files</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#directory-listing">Directory Listing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#path-formats-supported">Path Formats Supported</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#writing-files">Writing Files</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#basic-writing">Basic Writing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#important-rules">Important Rules</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#when-to-use-write_file">When to Use write_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#content-guidelines">Content Guidelines</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#editing-files">Editing Files</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#basic-editing">Basic Editing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#preserving-indentation">Preserving Indentation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ensuring-uniqueness">Ensuring Uniqueness</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#replace-all-occurrences">Replace All Occurrences</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#when-to-use-edit_file">When to Use edit_file</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#directory-listing_1">Directory Listing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-always-read-before-editing">1. Always Read Before Editing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-prefer-edit_file-over-write_file">2. Prefer edit_file Over write_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-use-parallel-reads">3. Use Parallel Reads</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#4-handle-large-files-efficiently">4. Handle Large Files Efficiently</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#5-verify-bundle-paths">5. Verify Bundle Paths</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#try-it-yourself">Try It Yourself</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-1-read-and-edit-a-file">Exercise 1: Read and Edit a File</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-2-explore-a-directory-structure">Exercise 2: Explore a Directory Structure</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exercise-3-variable-renaming">Exercise 3: Variable Renaming</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#errors-and-troubleshooting">Errors and Troubleshooting</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#error-must-read-file-before-editing">Error: "Must read file before editing"</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#error-old_string-not-unique">Error: "old_string not unique"</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#error-file-not-found">Error: "File not found"</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#warning-empty-file-contents">Warning: Empty File Contents</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#indentation-mismatch">Indentation Mismatch</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#line-truncation">Line Truncation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#advanced-patterns">Advanced Patterns</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#conditional-edits">Conditional Edits</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#multi-step-refactoring">Multi-Step Refactoring</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#safe-templating">Safe Templating</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="bash.html">Bash</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="search.html">Search (grep & glob)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="web.html">Web Tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="task.html">Task (Sub-Agents)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="lsp.html">LSP (Code Intelligence)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="recipes-tool.html">Recipes Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bundles Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../bundles/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bundles/foundation.html">Foundation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bundles/recipes.html">Recipes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bundles/lsp-python.html">LSP Python</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bundles/design-intelligence.html">Design Intelligence</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Skills Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../skills/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skills/playwright.html">Playwright</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skills/curl.html">Curl</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skills/image-vision.html">Image Vision</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../dev-setup/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev-setup/cli-tools.html">CLI Tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev-setup/shadow-workspace.html">Shadow Workspace</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev-setup/remote-dev.html">Remote Development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev-setup/debugging.html">Debugging</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../advanced/custom-bundle.html">Custom Bundles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../advanced/custom-tool.html">Custom Tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../advanced/custom-recipe.html">Custom Recipes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../advanced/mcp-integration.html">MCP Integration</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Amplifier Tutorial</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tools Reference</li>
      <li class="breadcrumb-item active">Filesystem</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="filesystem-tool">Filesystem Tool<a class="headerlink" href="#filesystem-tool" title="Permanent link">&para;</a></h1>
<p>The Filesystem Tool provides three essential operations for file manipulation: reading, writing, and editing files. These tools work with absolute paths, relative paths, and @mention paths for bundle resources.</p>
<h2 id="operations">Operations<a class="headerlink" href="#operations" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Tool</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read</td>
<td>read_file</td>
<td>Read file contents or list directories</td>
</tr>
<tr>
<td>Write</td>
<td>write_file</td>
<td>Create or overwrite entire files</td>
</tr>
<tr>
<td>Edit</td>
<td>edit_file</td>
<td>Perform surgical string replacements</td>
</tr>
</tbody>
</table>
<h2 id="reading-files">Reading Files<a class="headerlink" href="#reading-files" title="Permanent link">&para;</a></h2>
<p>The <code>read_file</code> tool reads file contents or lists directory contents with line numbers.</p>
<h3 id="basic-file-reading">Basic File Reading<a class="headerlink" href="#basic-file-reading" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/main.py&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p>Returns the file with line numbers in <code>cat -n</code> format:</p>
<div class="codehilite"><pre><span></span><code>1    import sys
2    
3    def main():
4        print(&quot;Hello, world!&quot;)
</code></pre></div>

<h3 id="reading-large-files">Reading Large Files<a class="headerlink" href="#reading-large-files" title="Permanent link">&para;</a></h3>
<p>For files with many lines, use <code>offset</code> and <code>limit</code> parameters:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./logs/app.log&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;offset&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;limit&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span>
<span class="p">}</span>
</code></pre></div>

<p>This reads lines 100-150, useful for:
- Inspecting specific sections of large logs
- Paginating through long files
- Reducing context consumption</p>
<p><strong>Default limits:</strong>
- Maximum 2000 lines per read
- Lines longer than 2000 characters are truncated
- Line numbers start at 1 (not 0)</p>
<h3 id="directory-listing">Directory Listing<a class="headerlink" href="#directory-listing" title="Permanent link">&para;</a></h3>
<p>When <code>file_path</code> points to a directory, <code>read_file</code> returns a formatted listing:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p>Returns:</p>
<div class="codehilite"><pre><span></span><code>DIR: components/
DIR: utils/
FILE: main.py
FILE: config.py
</code></pre></div>

<h3 id="path-formats-supported">Path Formats Supported<a class="headerlink" href="#path-formats-supported" title="Permanent link">&para;</a></h3>
<p><strong>Absolute paths:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/user/project/file.md&quot;</span><span class="p">}</span>
</code></pre></div>

<p><strong>Relative paths:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./docs/README.md&quot;</span><span class="p">}</span>
</code></pre></div>

<p><strong>Bundle resources:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;@mybundle:docs/guide.md&quot;</span><span class="p">}</span>
</code></pre></div>

<p><strong>Bundle directories:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;@mybundle:docs&quot;</span><span class="p">}</span>
</code></pre></div>

<h2 id="writing-files">Writing Files<a class="headerlink" href="#writing-files" title="Permanent link">&para;</a></h2>
<p>The <code>write_file</code> tool creates new files or overwrites existing ones completely.</p>
<h3 id="basic-writing">Basic Writing<a class="headerlink" href="#basic-writing" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/new_module.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def calculate(x, y):\n    return x + y\n&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="important-rules">Important Rules<a class="headerlink" href="#important-rules" title="Permanent link">&para;</a></h3>
<p>⚠️ <strong>MUST read existing files first:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Step 1: Read first</span>
<span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/existing.py&quot;</span><span class="p">}</span>

<span class="c1">// Step 2: Then write</span>
<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/existing.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;new content&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p>The tool will fail if you attempt to overwrite an existing file without reading it first. This safety mechanism prevents accidental overwrites.</p>
<h3 id="when-to-use-write_file">When to Use write_file<a class="headerlink" href="#when-to-use-write_file" title="Permanent link">&para;</a></h3>
<p><strong>✅ Good use cases:</strong>
- Creating entirely new files
- Generating configuration files
- Writing output from code generation
- Creating test fixtures</p>
<p><strong>❌ Avoid for:</strong>
- Modifying existing files (use <code>edit_file</code> instead)
- Small changes to files (use <code>edit_file</code> instead)
- Adding single functions to modules (use <code>edit_file</code> instead)</p>
<h3 id="content-guidelines">Content Guidelines<a class="headerlink" href="#content-guidelines" title="Permanent link">&para;</a></h3>
<ul>
<li>Avoid emoji unless explicitly requested by user</li>
<li>Never proactively create documentation (*.md) files</li>
<li>Always prefer editing existing files over creating new ones</li>
</ul>
<h2 id="editing-files">Editing Files<a class="headerlink" href="#editing-files" title="Permanent link">&para;</a></h2>
<p>The <code>edit_file</code> tool performs precise string replacements in existing files.</p>
<h3 id="basic-editing">Basic Editing<a class="headerlink" href="#basic-editing" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/main.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def calculate(x):\n    return x * 2&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def calculate(x, multiplier=2):\n    return x * multiplier&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="preserving-indentation">Preserving Indentation<a class="headerlink" href="#preserving-indentation" title="Permanent link">&para;</a></h3>
<p>⚠️ <strong>Critical:</strong> Preserve exact indentation as shown in <code>read_file</code> output.</p>
<p>The line number format is: <code>spaces + number + tab + content</code></p>
<p><strong>Example from read_file:</strong></p>
<div class="codehilite"><pre><span></span><code>    42    def helper():
    43        return True
</code></pre></div>

<p><strong>Correct old_string</strong> (after the tab):</p>
<div class="codehilite"><pre><span></span><code>&quot;def helper():\n    return True&quot;
</code></pre></div>

<p><strong>Incorrect</strong> (includes line numbers):</p>
<div class="codehilite"><pre><span></span><code>&quot;    42    def helper():\n    43        return True&quot;
</code></pre></div>

<h3 id="ensuring-uniqueness">Ensuring Uniqueness<a class="headerlink" href="#ensuring-uniqueness" title="Permanent link">&para;</a></h3>
<p>The tool requires <code>old_string</code> to be <strong>unique</strong> in the file:</p>
<p><strong>❌ Will fail</strong> (matches multiple locations):</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;return x&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>✅ Include context</strong> to make it unique:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def calculate(x):\n    return x&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="replace-all-occurrences">Replace All Occurrences<a class="headerlink" href="#replace-all-occurrences" title="Permanent link">&para;</a></h3>
<p>Use <code>replace_all: true</code> for renaming variables or repeated patterns:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/user.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;userName&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_name&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;replace_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Perfect for:</strong>
- Variable renaming across a file
- Updating repeated string literals
- Changing function names
- Updating import paths</p>
<h3 id="when-to-use-edit_file">When to Use edit_file<a class="headerlink" href="#when-to-use-edit_file" title="Permanent link">&para;</a></h3>
<p><strong>✅ Preferred for:</strong>
- Modifying functions or classes
- Adding imports
- Changing variable names
- Updating configuration values
- Bug fixes in existing code</p>
<p><strong>✅ Benefits:</strong>
- Preserves surrounding code
- Safer than full file rewrites
- More efficient for small changes
- Less prone to losing unrelated changes</p>
<h2 id="directory-listing_1">Directory Listing<a class="headerlink" href="#directory-listing_1" title="Permanent link">&para;</a></h2>
<p>List directory contents with <code>read_file</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/components&quot;</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>Output shows:</strong>
- <code>DIR:</code> prefix for subdirectories
- <code>FILE:</code> prefix for files
- Alphabetically sorted
- Relative names only (not full paths)</p>
<p><strong>Use cases:</strong>
- Exploring project structure
- Finding configuration files
- Discovering test files
- Checking bundle contents</p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-always-read-before-editing">1. Always Read Before Editing<a class="headerlink" href="#1-always-read-before-editing" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// ✅ Correct workflow</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./src/app.py&quot;</span><span class="err">)</span>
<span class="c1">// ... review contents ...</span>
<span class="err">edi</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./src/app.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">old_s</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="p">,</span><span class="w"> </span><span class="kc">ne</span><span class="err">w_s</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// ❌ Will fail</span>
<span class="err">edi</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./src/app.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">old_s</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="p">,</span><span class="w"> </span><span class="kc">ne</span><span class="err">w_s</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g)</span>
</code></pre></div>

<h3 id="2-prefer-edit_file-over-write_file">2. Prefer edit_file Over write_file<a class="headerlink" href="#2-prefer-edit_file-over-write_file" title="Permanent link">&para;</a></h3>
<p>For existing files, surgical edits are safer:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ✅ Preferred - surgical edit</span>
<span class="err">edi</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;version = \&quot;1.0\&quot;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;version = \&quot;2.0\&quot;&quot;</span>
<span class="p">}</span><span class="err">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="c1">// ❌ Risky - full rewrite</span>
<span class="err">wri</span><span class="kc">te</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;... entire file contents ...&quot;</span>
<span class="p">}</span><span class="err">)</span>
</code></pre></div>

<h3 id="3-use-parallel-reads">3. Use Parallel Reads<a class="headerlink" href="#3-use-parallel-reads" title="Permanent link">&para;</a></h3>
<p>Read multiple files in one message:</p>
<div class="codehilite"><pre><span></span><code><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/main.py&quot;</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/utils.py&quot;</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./tests/test_main.py&quot;</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>

<h3 id="4-handle-large-files-efficiently">4. Handle Large Files Efficiently<a class="headerlink" href="#4-handle-large-files-efficiently" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Check file size first</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./data/large.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="err">)</span>

<span class="c1">// Read in chunks if needed</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./data/large.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="err">)</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;./data/large.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="err">)</span>
</code></pre></div>

<h3 id="5-verify-bundle-paths">5. Verify Bundle Paths<a class="headerlink" href="#5-verify-bundle-paths" title="Permanent link">&para;</a></h3>
<p>For bundle resources, check directory listing first:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// List available files</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;@recipes:examples&quot;</span><span class="err">)</span>

<span class="c1">// Then read specific file</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="s2">&quot;@recipes:examples/workflow.yaml&quot;</span><span class="err">)</span>
</code></pre></div>

<h2 id="try-it-yourself">Try It Yourself<a class="headerlink" href="#try-it-yourself" title="Permanent link">&para;</a></h2>
<h3 id="exercise-1-read-and-edit-a-file">Exercise 1: Read and Edit a File<a class="headerlink" href="#exercise-1-read-and-edit-a-file" title="Permanent link">&para;</a></h3>
<ol>
<li>Create a test file:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="err">wri</span><span class="kc">te</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./test.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def greet(name):\n    return f&#39;Hello {name}&#39;&quot;</span>
<span class="p">}</span><span class="err">)</span>
</code></pre></div>

<ol>
<li>Read it back:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./test.py&quot;</span><span class="p">}</span><span class="err">)</span>
</code></pre></div>

<ol>
<li>Edit the function:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="err">edi</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./test.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def greet(name):\n    return f&#39;Hello {name}&#39;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;def greet(name, title=&#39;Friend&#39;):\n    return f&#39;Hello {title} {name}&#39;&quot;</span>
<span class="p">}</span><span class="err">)</span>
</code></pre></div>

<h3 id="exercise-2-explore-a-directory-structure">Exercise 2: Explore a Directory Structure<a class="headerlink" href="#exercise-2-explore-a-directory-structure" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./content&quot;</span><span class="p">}</span><span class="err">)</span>
<span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./content/tools&quot;</span><span class="p">}</span><span class="err">)</span>
</code></pre></div>

<h3 id="exercise-3-variable-renaming">Exercise 3: Variable Renaming<a class="headerlink" href="#exercise-3-variable-renaming" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="err">edi</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./src/config.py&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;maximum_retry_count&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;replace_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span><span class="err">)</span>
</code></pre></div>

<h2 id="errors-and-troubleshooting">Errors and Troubleshooting<a class="headerlink" href="#errors-and-troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="error-must-read-file-before-editing">Error: "Must read file before editing"<a class="headerlink" href="#error-must-read-file-before-editing" title="Permanent link">&para;</a></h3>
<p><strong>Cause:</strong> Attempted to edit without reading first.</p>
<p><strong>Solution:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="err">read_</span><span class="kc">f</span><span class="err">ile(</span><span class="p">{</span><span class="nt">&quot;file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;./target.py&quot;</span><span class="p">}</span><span class="err">)</span>
<span class="c1">// Then edit</span>
</code></pre></div>

<h3 id="error-old_string-not-unique">Error: "old_string not unique"<a class="headerlink" href="#error-old_string-not-unique" title="Permanent link">&para;</a></h3>
<p><strong>Cause:</strong> The string appears multiple times in the file.</p>
<p><strong>Solutions:</strong>
1. Add more context to make it unique:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;old_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;return value  // More context needed&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;new_string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function calculate() {\n    return value\n}&quot;</span>
<span class="p">}</span>
</code></pre></div>

<ol>
<li>Use <code>replace_all: true</code> if appropriate:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;replace_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}</span>
</code></pre></div>

<h3 id="error-file-not-found">Error: "File not found"<a class="headerlink" href="#error-file-not-found" title="Permanent link">&para;</a></h3>
<p><strong>Cause:</strong> Path doesn't exist or is incorrect.</p>
<p><strong>Solutions:</strong>
- Verify path with directory listing
- Check for typos in filename
- Use absolute path if relative path is ambiguous
- Confirm bundle name for @mention paths</p>
<h3 id="warning-empty-file-contents">Warning: Empty File Contents<a class="headerlink" href="#warning-empty-file-contents" title="Permanent link">&para;</a></h3>
<p>If you read a file that exists but is empty, you'll receive a warning. This helps distinguish between:
- File doesn't exist (error)
- File exists but is empty (warning)
- File has content (normal output)</p>
<h3 id="indentation-mismatch">Indentation Mismatch<a class="headerlink" href="#indentation-mismatch" title="Permanent link">&para;</a></h3>
<p><strong>Cause:</strong> Including line numbers or wrong whitespace in <code>old_string</code>.</p>
<p><strong>Solution:</strong>
- Copy exact content after the line number tab
- Preserve spaces/tabs exactly as shown
- Don't include the line number prefix</p>
<h3 id="line-truncation">Line Truncation<a class="headerlink" href="#line-truncation" title="Permanent link">&para;</a></h3>
<p>Lines longer than 2000 characters are truncated. For such files:
- Use specialized tools for specific content types (JSON parsers, etc.)
- Process in smaller chunks
- Consider using <code>bash</code> tool for stream processing</p>
<h2 id="advanced-patterns">Advanced Patterns<a class="headerlink" href="#advanced-patterns" title="Permanent link">&para;</a></h2>
<h3 id="conditional-edits">Conditional Edits<a class="headerlink" href="#conditional-edits" title="Permanent link">&para;</a></h3>
<p>Read first, decide, then edit based on content:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1. Read file</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;./config.yaml&quot;</span><span class="p">)</span>

<span class="c1"># 2. Analyze content</span>
<span class="k">if</span> <span class="s2">&quot;debug: false&quot;</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
    <span class="c1"># 3. Edit accordingly</span>
    <span class="n">edit_file</span><span class="p">(</span>
        <span class="n">old_string</span><span class="o">=</span><span class="s2">&quot;debug: false&quot;</span><span class="p">,</span>
        <span class="n">new_string</span><span class="o">=</span><span class="s2">&quot;debug: true&quot;</span>
    <span class="p">)</span>
</code></pre></div>

<h3 id="multi-step-refactoring">Multi-Step Refactoring<a class="headerlink" href="#multi-step-refactoring" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1. Read original</span>
<span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;./src/api.py&quot;</span><span class="p">)</span>

<span class="c1"># 2. First edit - rename function</span>
<span class="n">edit_file</span><span class="p">(</span><span class="n">old_string</span><span class="o">=</span><span class="s2">&quot;def old_name():&quot;</span><span class="p">,</span> <span class="n">new_string</span><span class="o">=</span><span class="s2">&quot;def new_name():&quot;</span><span class="p">)</span>

<span class="c1"># 3. Second edit - update callers</span>
<span class="n">edit_file</span><span class="p">(</span><span class="n">old_string</span><span class="o">=</span><span class="s2">&quot;old_name()&quot;</span><span class="p">,</span> <span class="n">new_string</span><span class="o">=</span><span class="s2">&quot;new_name()&quot;</span><span class="p">,</span> <span class="n">replace_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<h3 id="safe-templating">Safe Templating<a class="headerlink" href="#safe-templating" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># 1. Read template</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;@mybundle:templates/component.tsx&quot;</span><span class="p">)</span>

<span class="c1"># 2. Write new file with modifications</span>
<span class="n">write_file</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;./src/components/MyComponent.tsx&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{{NAME}}&quot;</span><span class="p">,</span> <span class="s2">&quot;MyComponent&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>The Filesystem Tool provides three complementary operations:</p>
<ul>
<li><strong>read_file</strong>: View contents, paginate large files, list directories</li>
<li><strong>write_file</strong>: Create new files (read existing files first!)</li>
<li><strong>edit_file</strong>: Surgical replacements (prefer over write_file)</li>
</ul>
<p><strong>Key principles:</strong>
1. Always read before editing
2. Prefer edit over write for existing files
3. Ensure old_string is unique or use replace_all
4. Preserve exact indentation from read_file output
5. Use parallel reads for efficiency</p>
<p>These tools form the foundation of file manipulation in Amplifier, enabling precise control over your project's files.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="bash.html" class="btn btn-neutral float-right" title="Bash">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="index.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="bash.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
